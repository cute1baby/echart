#!/bin/bash


source /tmp/xml/db.sh 

#Don't revise the content below
#echo -e ""

echo -e ".Database Server IP:"$db_ip 
echo -e ".Database Server Port:(3306):"$db_port
echo -e ".Company  Code:"$db_company
echo -e ".user:"$db_user
echo -e ".password:"$db_password




TIP_BEGIN="..................Now begin to run:  "
TIP="..........."
TIP_END="..is done"


ERROR=".Found error:"
#Where to save xml
PATH_XML=/var/www/html/


echo -e ".Get data now......................."


for b in "LIKE 'com.tencent.mobileqq'" "='com.tencent.mm'"
do

for a in "CURDATE()"  "DATE_ADD(CURDATE(), INTERVAL - 6 DAY)"  "DATE_ADD(CURDATE(),INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY)"  "DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY )"    

do 
	if [ "$a" == "CURDATE()" ];
	then
	  d=1
	elif [ "$a" == "DATE_ADD(CURDATE(), INTERVAL - 6 DAY)" ];
	  then
	  d=2
	elif [ "$a" == "DATE_ADD(CURDATE(),INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY)" ];
	  then
	  d=3
	else
	  d=4
	fi
   
   
   
for i  in `mysql -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company";select sensitive_name from ( SELECT sensitive_name, COUNT(sensitive_name) AS num FROM behavior_sensitive_word_report WHERE sensitive_source $b AND use_date >=$a  GROUP BY sensitive_name ORDER BY num DESC limit 20) as tmp;" | grep -v sensitive_name`
do
	

	if [ "$b" == "LIKE 'com.tencent.mobileqq'" ];
    then
       mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select w.sensitive_name,s.name,COUNT(w.user_id) as num , $a AS startData, CURDATE() AS endDate from behavior_sensitive_word_report w LEFT JOIN sys_user s on s.user_id =w.user_id where sensitive_source $b and sensitive_name = '$i' AND use_date >= $a GROUP BY w.user_id ORDER BY num desc limit 20;" > /tmp/xml/qq_key_"$i"_$d.xml
	   echo /tmp/xml/qq_key_"$i"_$d.xml   
   else
       mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select w.sensitive_name,s.name,COUNT(w.user_id) as num , $a AS startData, CURDATE() AS endDate from behavior_sensitive_word_report w LEFT JOIN sys_user s on s.user_id =w.user_id where sensitive_source $b and sensitive_name = '$i' AND use_date >= $a GROUP BY w.user_id ORDER BY num desc limit 20;" > /tmp/xml/wx_key_"$i"_$d.xml
	   echo /tmp/xml/wx_key_"$i"_$d.xml
	fi
    

done
done

done

#!/bin/bash
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,CURDATE()  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >=CURDATE() and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 and log.chat_status=0 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_0_0_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -6 DAY)  as startData   FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 and log.chat_status=0 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_0_0_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 and log.chat_status=0 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_0_0_3.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 and log.chat_status=0 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_0_0_4.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,CURDATE()  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >=CURDATE() and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 and log.chat_status=1 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_0_1_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -6 DAY)  as startData   FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 and log.chat_status=1 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_0_1_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 and log.chat_status=1 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_0_1_3.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 and log.chat_status=1 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_0_1_4.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,CURDATE()  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >=CURDATE() and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1 and log.chat_status=0 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_1_0_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -6 DAY)  as startData   FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1 and log.chat_status=0 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_1_0_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1 and log.chat_status=0 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_1_0_3.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1 and log.chat_status=0 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_1_0_4.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,CURDATE()  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >=CURDATE() and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1 and log.chat_status=1 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_1_1_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -6 DAY)  as startData   FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1 and log.chat_status=1 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_1_1_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1 and log.chat_status=1 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_1_1_3.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1 and log.chat_status=1 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_1_1_4.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,CURDATE()  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >=CURDATE() and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 and log.chat_status=0 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_0_0_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -6 DAY)  as startData   FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 and log.chat_status=0 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_0_0_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 and log.chat_status=0 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_0_0_3.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 and log.chat_status=0 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_0_0_4.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,CURDATE()  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >=CURDATE() and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 and log.chat_status=1 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_0_1_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -6 DAY)  as startData   FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 and log.chat_status=1 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_0_1_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 and log.chat_status=1 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_0_1_3.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 and log.chat_status=1 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_0_1_4.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,CURDATE()  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >=CURDATE() and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1 and log.chat_status=0 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_1_0_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -6 DAY)  as startData   FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1 and log.chat_status=0 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_1_0_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1 and log.chat_status=0 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_1_0_3.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1 and log.chat_status=0 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_1_0_4.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,CURDATE()  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >=CURDATE() and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1 and log.chat_status=1 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_1_1_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -6 DAY)  as startData   FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1 and log.chat_status=1 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_1_1_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1 and log.chat_status=1 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_1_1_3.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1 and log.chat_status=1 GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_1_1_4.xml; 
# 应用：qq 对象：个人  方式：所有  日期：今天   
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,CURDATE()  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >=CURDATE() and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0   GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_0_2_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -6 DAY)  as startData   FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0   GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_0_2_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0   GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_0_2_3.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0   GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_0_2_4.xml; 

# 应用：qq 对象：群组  方式：所有  日期：今天   
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,CURDATE()  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >=CURDATE() and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1   GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_1_2_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -6 DAY)  as startData   FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1   GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_1_2_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1   GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_1_2_3.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1   GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/qq_dx_1_2_4.xml; 

# 应用：微信 对象：个人  方式：所有  日期：今天  
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,CURDATE()  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >=CURDATE() and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0   GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_0_2_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -6 DAY)  as startData   FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0   GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_0_2_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0   GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_0_2_3.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0   GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_0_2_4.xml; 
# 应用：微信 对象：群组  方式：所有  日期：今天  
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,CURDATE()  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >=CURDATE() and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1   GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_1_2_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -6 DAY)  as startData   FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1   GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_1_2_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1   GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_1_2_3.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(audit.staff_id)as num ,s.staff_name, CURDATE() as endDate,DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1   GROUP BY audit.staff_id order by num desc LIMIT 50;" > /tmp/xml/wx_dx_1_2_4.xml; 



#内容统计
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,log.chat_status,COUNT(log.content_type)as num , CURDATE() as endDate,CURDATE()  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >=CURDATE() and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 GROUP BY log.content_type,log.chat_status ;" > /tmp/xml/qq_nr_sum_0_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,log.chat_status,COUNT(log.content_type)as num , CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -6 DAY)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 GROUP BY log.content_type,log.chat_status ;" > /tmp/xml/qq_nr_sum_0_2.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,log.chat_status,COUNT(log.content_type)as num , CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 GROUP BY log.content_type,log.chat_status ;" > /tmp/xml/qq_nr_sum_0_3.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,log.chat_status,COUNT(log.content_type)as num , CURDATE() as endDate,DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 GROUP BY log.content_type,log.chat_status ;" > /tmp/xml/qq_nr_sum_0_4.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,COUNT(log.content_type)as num , CURDATE() as endDate,CURDATE()  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >=CURDATE() and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1 GROUP BY log.content_type ;" > /tmp/xml/qq_nr_sum_1_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,COUNT(log.content_type)as num , CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -6 DAY)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1 GROUP BY log.content_type ;" > /tmp/xml/qq_nr_sum_1_2.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,COUNT(log.content_type)as num , CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1 GROUP BY log.content_type ;" > /tmp/xml/qq_nr_sum_1_3.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,COUNT(log.content_type)as num , CURDATE() as endDate,DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1 GROUP BY log.content_type ;" > /tmp/xml/qq_nr_sum_1_4.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,log.chat_status,COUNT(log.content_type)as num , CURDATE() as endDate,CURDATE()  as startData FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >=CURDATE() and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 GROUP BY log.content_type,log.chat_status ;" > /tmp/xml/wx_nr_sum_0_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,log.chat_status,COUNT(log.content_type)as num , CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -6 DAY)  as startData FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 GROUP BY log.content_type,log.chat_status ;" > /tmp/xml/wx_nr_sum_0_2.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,log.chat_status,COUNT(log.content_type)as num , CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 GROUP BY log.content_type,log.chat_status ;" > /tmp/xml/wx_nr_sum_0_3.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,log.chat_status,COUNT(log.content_type)as num , CURDATE() as endDate,DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 GROUP BY log.content_type,log.chat_status ;" > /tmp/xml/wx_nr_sum_0_4.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,COUNT(log.content_type)as num , CURDATE() as endDate,CURDATE()  as startData FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >=CURDATE() and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1 GROUP BY log.content_type ;" > /tmp/xml/wx_nr_sum_1_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,COUNT(log.content_type)as num , CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -6 DAY)  as startData FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1 GROUP BY log.content_type ;" > /tmp/xml/wx_nr_sum_1_2.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,COUNT(log.content_type)as num , CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1 GROUP BY log.content_type ;" > /tmp/xml/wx_nr_sum_1_3.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,COUNT(log.content_type)as num , CURDATE() as endDate,DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1 GROUP BY log.content_type ;" > /tmp/xml/wx_nr_sum_1_4.xml; 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.group_id,log.group_name,log.content_type, count(log.content_type) AS num, CURDATE() as endDate ,CURDATE()  as startData FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id INNER JOIN ( SELECT log.group_id, count(log.group_id) AS num FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.talk_type = 1 AND log.chat_time >= CURDATE() GROUP BY log.group_id ORDER BY num LIMIT 50 ) AS tmp ON log.group_id = tmp.group_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.talk_type = 1 AND log.chat_time >= CURDATE() GROUP BY log.group_id, log.content_type ORDER BY tmp.num DESC;" > /tmp/xml/qq_nr_1_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.group_id,log.group_name,log.content_type, count(log.content_type) AS num, CURDATE() as endDate ,DATE_ADD(CURDATE(),INTERVAL -6 DAY)  as startData FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id INNER JOIN ( SELECT log.group_id, count(log.group_id) AS num FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) GROUP BY log.group_id ORDER BY num LIMIT 50 ) AS tmp ON log.group_id = tmp.group_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) GROUP BY log.group_id, log.content_type ORDER BY tmp.num DESC;" > /tmp/xml/qq_nr_1_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.group_id,log.group_name,log.content_type, count(log.content_type) AS num, CURDATE() as endDate ,DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id INNER JOIN ( SELECT log.group_id, count(log.group_id) AS num FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) GROUP BY log.group_id ORDER BY num LIMIT 50 ) AS tmp ON log.group_id = tmp.group_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) GROUP BY log.group_id, log.content_type ORDER BY tmp.num DESC;" > /tmp/xml/qq_nr_1_3.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.group_id,log.group_name,log.content_type, count(log.content_type) AS num, CURDATE() as endDate ,DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id INNER JOIN ( SELECT log.group_id, count(log.group_id) AS num FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) GROUP BY log.group_id ORDER BY num LIMIT 50 ) AS tmp ON log.group_id = tmp.group_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) GROUP BY log.group_id, log.content_type ORDER BY tmp.num DESC;" > /tmp/xml/qq_nr_1_4.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.group_id,log.group_name,log.content_type, count(log.content_type) AS num , CURDATE() as endDate,CURDATE()  as startData FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id INNER JOIN ( SELECT log.group_id, count(log.group_id) AS num FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.talk_type = 1 AND log.chat_time >= CURDATE() GROUP BY log.group_id ORDER BY num LIMIT 50 ) AS tmp ON log.group_id = tmp.group_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.talk_type = 1 AND log.chat_time >= CURDATE() GROUP BY log.group_id, log.content_type ORDER BY tmp.num DESC;" > /tmp/xml/wx_nr_1_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.group_id,log.group_name,log.content_type, count(log.content_type) AS num , CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -6 DAY)  as startData FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id INNER JOIN ( SELECT log.group_id, count(log.group_id) AS num FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) GROUP BY log.group_id ORDER BY num LIMIT 50 ) AS tmp ON log.group_id = tmp.group_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) GROUP BY log.group_id, log.content_type ORDER BY tmp.num DESC;" > /tmp/xml/wx_nr_1_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.group_id,log.group_name,log.content_type, count(log.content_type) AS num , CURDATE() as endDate,DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id INNER JOIN ( SELECT log.group_id, count(log.group_id) AS num FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) GROUP BY log.group_id ORDER BY num LIMIT 50 ) AS tmp ON log.group_id = tmp.group_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) GROUP BY log.group_id, log.content_type ORDER BY tmp.num DESC;" > /tmp/xml/wx_nr_1_3.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.group_id,log.group_name,log.content_type, count(log.content_type) AS num , CURDATE() as endDate,DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day)  as startData  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id INNER JOIN ( SELECT log.group_id, count(log.group_id) AS num FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) GROUP BY log.group_id ORDER BY num LIMIT 50 ) AS tmp ON log.group_id = tmp.group_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) GROUP BY log.group_id, log.content_type ORDER BY tmp.num DESC;" > /tmp/xml/wx_nr_1_4.xml;


#QQ  内容-文字二级列表统计
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, COUNT(tmp.behavior_chat_log_id) urlNum,CURDATE() AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id  left join ( SELECT behavior_chat_log_id FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time >= CURDATE() AND ( CAST(log.chat_content AS CHAR) LIKE '%http://%' OR CAST(log.chat_content AS CHAR) LIKE '%https://%' ) ) AS tmp on log.behavior_chat_log_id =tmp.behavior_chat_log_id  WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time >= CURDATE() GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/qq_nr_1_1_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, COUNT(tmp.behavior_chat_log_id) urlNum,DATE_ADD(CURDATE(), INTERVAL - 6 DAY) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id  left join ( SELECT behavior_chat_log_id FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY) AND ( CAST(log.chat_content AS CHAR) LIKE '%http://%' OR CAST(log.chat_content AS CHAR) LIKE '%https://%' ) ) AS tmp on log.behavior_chat_log_id =tmp.behavior_chat_log_id  WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/qq_nr_1_1_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, COUNT(tmp.behavior_chat_log_id) urlNum,DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id left join ( SELECT behavior_chat_log_id FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time >= DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AND ( CAST(log.chat_content AS CHAR) LIKE '%http://%' OR CAST(log.chat_content AS CHAR) LIKE '%https://%' ) ) AS tmp on log.behavior_chat_log_id =tmp.behavior_chat_log_id  WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/qq_nr_1_1_3.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, COUNT(tmp.behavior_chat_log_id) urlNum,DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id left join ( SELECT behavior_chat_log_id FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time >= DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AND ( CAST(log.chat_content AS CHAR) LIKE '%http://%' OR CAST(log.chat_content AS CHAR) LIKE '%https://%' ) ) AS tmp on log.behavior_chat_log_id =tmp.behavior_chat_log_id  WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/qq_nr_1_1_4.xml;

mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, CURDATE() AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 2 AND log.talk_type = 1 AND log.chat_time >= CURDATE() GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/qq_nr_1_2_1.xml
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, DATE_ADD(CURDATE(), INTERVAL - 6 DAY) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 2 AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/qq_nr_1_2_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 2 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/qq_nr_1_2_3.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 2 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/qq_nr_1_2_4.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, CURDATE() AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 3 AND log.talk_type = 1 AND log.chat_time >= CURDATE() GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/qq_nr_1_3_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, DATE_ADD(CURDATE(), INTERVAL - 6 DAY) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 3 AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/qq_nr_1_3_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 3 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/qq_nr_1_3_3.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 3 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/qq_nr_1_3_4.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, CURDATE() AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 4 AND log.talk_type = 1 AND log.chat_time >= CURDATE() GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/qq_nr_1_4_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, DATE_ADD(CURDATE(), INTERVAL - 6 DAY) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 4 AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/qq_nr_1_4_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 4 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/qq_nr_1_4_3.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 4 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/qq_nr_1_4_4.xml;

#微信  内容  文字 二级列表统计
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, COUNT(tmp.behavior_chat_log_id) urlNum,CURDATE() AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id  left join ( SELECT behavior_chat_log_id FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time >= CURDATE() AND ( CAST(log.chat_content AS CHAR) LIKE '%http://%' OR CAST(log.chat_content AS CHAR) LIKE '%https://%' ) ) AS tmp on log.behavior_chat_log_id =tmp.behavior_chat_log_id  WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time >= CURDATE() GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/wx_nr_1_1_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, COUNT(tmp.behavior_chat_log_id) urlNum,DATE_ADD(CURDATE(), INTERVAL - 6 DAY) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id  left join ( SELECT behavior_chat_log_id FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY) AND ( CAST(log.chat_content AS CHAR) LIKE '%http://%' OR CAST(log.chat_content AS CHAR) LIKE '%https://%' ) ) AS tmp on log.behavior_chat_log_id =tmp.behavior_chat_log_id  WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/wx_nr_1_1_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, COUNT(tmp.behavior_chat_log_id) urlNum,DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id left join ( SELECT behavior_chat_log_id FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time >= DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AND ( CAST(log.chat_content AS CHAR) LIKE '%http://%' OR CAST(log.chat_content AS CHAR) LIKE '%https://%' ) ) AS tmp on log.behavior_chat_log_id =tmp.behavior_chat_log_id  WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/wx_nr_1_1_3.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, COUNT(tmp.behavior_chat_log_id) urlNum,DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id left join ( SELECT behavior_chat_log_id FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time >= DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AND ( CAST(log.chat_content AS CHAR) LIKE '%http://%' OR CAST(log.chat_content AS CHAR) LIKE '%https://%' ) ) AS tmp on log.behavior_chat_log_id =tmp.behavior_chat_log_id  WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/wx_nr_1_1_4.xml;

mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, CURDATE() AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 2 AND log.talk_type = 1 AND log.chat_time >= CURDATE() GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/wx_nr_1_2_1.xml
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, DATE_ADD(CURDATE(), INTERVAL - 6 DAY) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 2 AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/wx_nr_1_2_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 2 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/wx_nr_1_2_3.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 2 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/wx_nr_1_2_4.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, CURDATE() AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 3 AND log.talk_type = 1 AND log.chat_time >= CURDATE() GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/wx_nr_1_3_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, DATE_ADD(CURDATE(), INTERVAL - 6 DAY) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 3 AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/wx_nr_1_3_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 3 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/wx_nr_1_3_3.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 3 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/wx_nr_1_3_4.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, CURDATE() AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 4 AND log.talk_type = 1 AND log.chat_time >= CURDATE() GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/wx_nr_1_4_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, DATE_ADD(CURDATE(), INTERVAL - 6 DAY) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 4 AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/wx_nr_1_4_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 4 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/wx_nr_1_4_3.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type, log.group_name, count(log.group_id) AS num, DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 4 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY log.group_id ORDER BY num DESC LIMIT 20;" > /tmp/xml/wx_nr_1_4_4.xml;

mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select sensitive_source, sensitive_name, COUNT(sensitive_name) AS num, CURDATE() AS startData, CURDATE() AS endDate FROM behavior_sensitive_word_report WHERE sensitive_source LIKE 'com.tencent.%qq%' AND use_date >= CURDATE() GROUP BY sensitive_name ORDER BY num DESC limit 20;" > /tmp/xml/qq_key_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select sensitive_source, sensitive_name, COUNT(sensitive_name) AS num, DATE_ADD(CURDATE(), INTERVAL - 6 DAY) AS startData, CURDATE() AS endDate FROM behavior_sensitive_word_report WHERE sensitive_source LIKE 'com.tencent.%qq%' AND use_date >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY) GROUP BY sensitive_name ORDER BY num DESC limit 20;" > /tmp/xml/qq_key_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select sensitive_source, sensitive_name, COUNT(sensitive_name) AS num, DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_sensitive_word_report WHERE sensitive_source LIKE 'com.tencent.%qq%' AND use_date >= DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY sensitive_name ORDER BY num DESC limit 20;" > /tmp/xml/qq_key_3.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select sensitive_source, sensitive_name, COUNT(sensitive_name) AS num, DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_sensitive_word_report WHERE sensitive_source LIKE 'com.tencent.%qq%' AND use_date >= DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY sensitive_name ORDER BY num DESC limit 20;" > /tmp/xml/qq_key_4.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select sensitive_source, sensitive_name, COUNT(sensitive_name) AS num, CURDATE() AS startData, CURDATE() AS endDate FROM behavior_sensitive_word_report WHERE sensitive_source ='com.tencent.mm' AND use_date >= CURDATE() GROUP BY sensitive_name ORDER BY num DESC limit 20;" > /tmp/xml/wx_key_1.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select sensitive_source, sensitive_name, COUNT(sensitive_name) AS num, DATE_ADD(CURDATE(), INTERVAL - 6 DAY) AS startData, CURDATE() AS endDate FROM behavior_sensitive_word_report WHERE sensitive_source ='com.tencent.mm' AND use_date >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY) GROUP BY sensitive_name ORDER BY num DESC limit 20;" > /tmp/xml/wx_key_2.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select sensitive_source, sensitive_name, COUNT(sensitive_name) AS num, DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_sensitive_word_report WHERE sensitive_source ='com.tencent.mm' AND use_date >= DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY sensitive_name ORDER BY num DESC limit 20;" > /tmp/xml/wx_key_3.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select sensitive_source, sensitive_name, COUNT(sensitive_name) AS num, DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) AS startData, CURDATE() AS endDate FROM behavior_sensitive_word_report WHERE sensitive_source ='com.tencent.mm' AND use_date >= DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) GROUP BY sensitive_name ORDER BY num DESC limit 20;" > /tmp/xml/wx_key_4.xml;
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select CURDATE() as date ,DATE_ADD(CURDATE(), INTERVAL - 6 DAY) as weekday ,DATE_ADD(CURDATE(),INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY) as oneMonth,DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) as threeMonth;" > /tmp/xml/date.xml;


######################################################################################################## 
# 统计链接 应用：QQ 对象：个人   日期：今天 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(log.chat_status) AS num, log.chat_status FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >=CURDATE() and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 and (CAST(log.chat_content AS char) like '%http://%' or CAST(log.chat_content AS char) like '%https://%' ) GROUP BY log.chat_status order by num desc LIMIT 20;" > /tmp/xml/qq_nr_url_0_1.xml; 
# 统计链接 应用：QQ 对象：个人   日期：最近7天（算当天） 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(log.chat_status) AS num, log.chat_status FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 and (CAST(log.chat_content AS char) like '%http://%' or CAST(log.chat_content AS char) like '%https://%' ) GROUP BY log.chat_status order by num desc LIMIT 20;" > /tmp/xml/qq_nr_url_0_2.xml;  
# 统计链接 应用：QQ 对象：个人   日期：本月 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(log.chat_status) AS num, log.chat_status FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 and (CAST(log.chat_content AS char) like '%http://%' or CAST(log.chat_content AS char) like '%https://%' ) GROUP BY log.chat_status order by num desc LIMIT 20;" > /tmp/xml/qq_nr_url_0_3.xml; 
# 统计链接 应用：QQ 对象：个人   日期：近三月 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(log.chat_status) AS num, log.chat_status FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time > DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 and (CAST(log.chat_content AS char) like '%http://%' or CAST(log.chat_content AS char) like '%https://%' ) GROUP BY log.chat_status order by num desc LIMIT 20;" > /tmp/xml/qq_nr_url_0_4.xml; 
######################################################################################################## 
# 统计链接 应用：微信 对象：个人   日期：今天 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(log.chat_status) AS num, log.chat_status FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >=CURDATE() and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 and (CAST(log.chat_content AS char) like '%http://%' or CAST(log.chat_content AS char) like '%https://%' ) GROUP BY log.chat_status order by num desc LIMIT 20;" > /tmp/xml/wx_nr_url_0_1.xml;
# 统计链接 应用：微信 对象：个人   日期：最近7天（算当天） 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(log.chat_status) AS num, log.chat_status FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 and (CAST(log.chat_content AS char) like '%http://%' or CAST(log.chat_content AS char) like '%https://%' ) GROUP BY log.chat_status order by num desc LIMIT 20;" > /tmp/xml/wx_nr_url_0_2.xml;
# 统计链接 应用：微信 对象：个人   日期：本月 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(log.chat_status) AS num, log.chat_status FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 and (CAST(log.chat_content AS char) like '%http://%' or CAST(log.chat_content AS char) like '%https://%' ) GROUP BY log.chat_status order by num desc LIMIT 20;" > /tmp/xml/wx_nr_url_0_3.xml;
# 统计链接 应用：微信 对象：个人   日期：近三月 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(log.chat_status) AS num, log.chat_status FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time > DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 and (CAST(log.chat_content AS char) like '%http://%' or CAST(log.chat_content AS char) like '%https://%' ) GROUP BY log.chat_status order by num desc LIMIT 20;" > /tmp/xml/wx_nr_url_0_4.xml;



# 应用：QQ 对象   个人 日期：当天 7天 当月 3个月 
mysql -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company";SELECT CONCAT( s.staff_name, '||', CAST(log.chat_content AS CHAR) ) FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%'  and log.talk_type =0 and log.chat_time >= CURDATE() ;" > /tmp/xml/qq_focus_0_1;      
mysql -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company";SELECT CONCAT( s.staff_name, '||', CAST(log.chat_content AS CHAR) ) FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%'  and log.talk_type =0 and log.chat_time >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY);" > /tmp/xml/qq_focus_0_2;     
mysql -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company";SELECT CONCAT( s.staff_name, '||', CAST(log.chat_content AS CHAR) ) FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%'  and log.talk_type =0 and log.chat_time >= DATE_ADD(	CURDATE(),	INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY);" > /tmp/xml/qq_focus_0_3;     
mysql -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company";SELECT CONCAT( s.staff_name, '||', CAST(log.chat_content AS CHAR) ) FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%'  and log.talk_type =0 and log.chat_time >= DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY );" > /tmp/xml/qq_focus_0_4;      
# 应用：微信 对象 个人  日期：当天 7天 当月 3个月 
mysql -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company";SELECT CONCAT( s.staff_name, '||', CAST(log.chat_content AS CHAR) ) FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id WHERE audit.app_pkg_name ='com.tencent.mm'  and log.talk_type =0 and log.chat_time >= CURDATE();" > /tmp/xml/wx_focus_0_1;    
mysql -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company";SELECT CONCAT( s.staff_name, '||', CAST(log.chat_content AS CHAR) ) FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id WHERE audit.app_pkg_name ='com.tencent.mm'  and log.talk_type =0 and log.chat_time >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY);" > /tmp/xml/wx_focus_0_2;     
mysql -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company";SELECT CONCAT( s.staff_name, '||', CAST(log.chat_content AS CHAR) ) FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id WHERE audit.app_pkg_name ='com.tencent.mm'  and log.talk_type =0 and log.chat_time >= DATE_ADD(	CURDATE(),	INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY);" > /tmp/xml/wx_focus_0_3;     
mysql -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company";SELECT CONCAT( s.staff_name, '||', CAST(log.chat_content AS CHAR) ) FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id WHERE audit.app_pkg_name ='com.tencent.mm'  and log.talk_type =0 and log.chat_time >= DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY );" > /tmp/xml/wx_focus_0_4;      


# 应用：QQ 对象 群组 日期：当天 7天 当月 3个月 
mysql -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company";SELECT CONCAT( s.staff_name, '||', CAST(log.chat_content AS CHAR) ) FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%'  and log.talk_type =1 and log.chat_time >= CURDATE() ;" > /tmp/xml/qq_focus_1_1;      
mysql -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company";SELECT CONCAT( s.staff_name, '||', CAST(log.chat_content AS CHAR) ) FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%'  and log.talk_type =1 and log.chat_time >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY);" > /tmp/xml/qq_focus_1_2;     
mysql -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company";SELECT CONCAT( s.staff_name, '||', CAST(log.chat_content AS CHAR) ) FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%'  and log.talk_type =1 and log.chat_time >= DATE_ADD(	CURDATE(),	INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY);" > /tmp/xml/qq_focus_1_3;     
mysql -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company";SELECT CONCAT( s.staff_name, '||', CAST(log.chat_content AS CHAR) ) FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%'  and log.talk_type =1 and log.chat_time >= DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY );" > /tmp/xml/qq_focus_1_4;    
# 应用：微信 对象 群组 日期：当天 7天 当月 3个月 
mysql -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company";SELECT CONCAT( s.staff_name, '||', CAST(log.chat_content AS CHAR) ) FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id WHERE audit.app_pkg_name ='com.tencent.mm'  and log.talk_type =1 and log.chat_time >= CURDATE();" > /tmp/xml/wx_focus_1_1;    
mysql -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company";SELECT CONCAT( s.staff_name, '||', CAST(log.chat_content AS CHAR) ) FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id WHERE audit.app_pkg_name ='com.tencent.mm'  and log.talk_type =1 and log.chat_time >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY);" > /tmp/xml/wx_focus_1_2;     
mysql -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company";SELECT CONCAT( s.staff_name, '||', CAST(log.chat_content AS CHAR) ) FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id WHERE audit.app_pkg_name ='com.tencent.mm'  and log.talk_type =1 and log.chat_time >= DATE_ADD(	CURDATE(),	INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY);" > /tmp/xml/wx_focus_1_3;     
mysql -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company";SELECT CONCAT( s.staff_name, '||', CAST(log.chat_content AS CHAR) ) FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id WHERE audit.app_pkg_name ='com.tencent.mm'  and log.talk_type =1 and log.chat_time >= DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY );" > /tmp/xml/wx_focus_1_4;      



#qq 内容-文字url统计  个人
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(log.behavior_chat_log_id) urlNum,'1' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 1 AND log.talk_type = 0 AND log.chat_time >= CURDATE() Union select COUNT(log.behavior_chat_log_id) urlNum,'2' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 1 AND log.talk_type = 0 AND log.chat_time >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY)  Union select COUNT(log.behavior_chat_log_id) urlNum,'3' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 1 AND log.talk_type = 0 AND log.chat_time > DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) Union select COUNT(log.behavior_chat_log_id) urlNum,'4' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id  WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 1 AND log.talk_type = 0 AND log.chat_time > DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) ;" > /tmp/xml/qq_sum_url_0.xml;

#qq 内容-文字url统计  群组
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(log.behavior_chat_log_id) urlNum,'1' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time >= CURDATE() Union select COUNT(log.behavior_chat_log_id) urlNum,'2' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY)  Union select COUNT(log.behavior_chat_log_id) urlNum,'3' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) Union select COUNT(log.behavior_chat_log_id) urlNum,'4' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id  WHERE audit.app_pkg_name LIKE 'com.tencent.%qq%' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) ;" > /tmp/xml/qq_sum_url_1.xml;


#wx 内容-文字url统计  个人
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(log.behavior_chat_log_id) urlNum,'1' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 1 AND log.talk_type = 0 AND log.chat_time >= CURDATE() Union select COUNT(log.behavior_chat_log_id) urlNum,'2' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 1 AND log.talk_type = 0 AND log.chat_time >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY)  Union select COUNT(log.behavior_chat_log_id) urlNum,'3' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 1 AND log.talk_type = 0 AND log.chat_time > DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) Union select COUNT(log.behavior_chat_log_id) urlNum,'4' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id  WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 1 AND log.talk_type = 0 AND log.chat_time > DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) ;" > /tmp/xml/wx_sum_url_0.xml;

#wx 内容-文字url统计  群组
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select COUNT(log.behavior_chat_log_id) urlNum,'1' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time >= CURDATE() Union select COUNT(log.behavior_chat_log_id) urlNum,'2' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time >= DATE_ADD(CURDATE(), INTERVAL - 6 DAY)  Union select COUNT(log.behavior_chat_log_id) urlNum,'3' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( CURDATE(), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) Union select COUNT(log.behavior_chat_log_id) urlNum,'4' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id  WHERE audit.app_pkg_name ='com.tencent.mm' AND log.content_type = 1 AND log.talk_type = 1 AND log.chat_time > DATE_ADD( DATE_ADD(CURDATE(), INTERVAL - 2 MONTH), INTERVAL - (DAYOFMONTH(CURDATE()) - 1) DAY ) ;" > /tmp/xml/wx_sum_url_1.xml;



#内容统计  QQ  个人 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,COUNT(log.content_type)as num ,"1"  as date_type  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >=CURDATE() and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 GROUP BY log.content_type UNION  select log.content_type,COUNT(log.content_type)as num ,"2"  as date_type  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 GROUP BY log.content_type UNION select log.content_type,COUNT(log.content_type)as num ,"3"  as date_type  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 GROUP BY log.content_type  UNION  select log.content_type,COUNT(log.content_type)as num , "4"  as date_type  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0 GROUP BY log.content_type ;" > /tmp/xml/qq_sum_nr_0.xml;

#内容统计  QQ  群组 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,COUNT(log.content_type)as num ,"1"  as date_type  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >=CURDATE() and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1 GROUP BY log.content_type UNION  select log.content_type,COUNT(log.content_type)as num ,"2"  as date_type  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1 GROUP BY log.content_type UNION select log.content_type,COUNT(log.content_type)as num ,"3"  as date_type  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1 GROUP BY log.content_type  UNION  select log.content_type,COUNT(log.content_type)as num , "4"  as date_type  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1 GROUP BY log.content_type ;" > /tmp/xml/qq_sum_nr_1.xml;

#内容统计  微信  个人 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,COUNT(log.content_type)as num ,"1"  as date_type  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >=CURDATE() and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 GROUP BY log.content_type UNION  select log.content_type,COUNT(log.content_type)as num ,"2"  as date_type  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 GROUP BY log.content_type UNION select log.content_type,COUNT(log.content_type)as num ,"3"  as date_type  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 GROUP BY log.content_type  UNION  select log.content_type,COUNT(log.content_type)as num , "4"  as date_type  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0 GROUP BY log.content_type ;" > /tmp/xml/wx_sum_nr_0.xml;

#内容统计  微信 群组 
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; select log.content_type,COUNT(log.content_type)as num ,"1"  as date_type  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >=CURDATE() and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1 GROUP BY log.content_type UNION  select log.content_type,COUNT(log.content_type)as num ,"2"  as date_type  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1 GROUP BY log.content_type UNION select log.content_type,COUNT(log.content_type)as num ,"3"  as date_type  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1 GROUP BY log.content_type  UNION  select log.content_type,COUNT(log.content_type)as num , "4"  as date_type  FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1 GROUP BY log.content_type ;" > /tmp/xml/wx_sum_nr_1.xml;


#QQ 个人 聊天记录统计
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; (select COUNT(audit.staff_id)as num ,s.staff_name, '1' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >=CURDATE() and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0  GROUP BY audit.staff_id order by num desc LIMIT 20) UNION  (select COUNT(audit.staff_id)as num ,s.staff_name, '2' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0  GROUP BY audit.staff_id order by num desc LIMIT 20 ) UNION (select COUNT(audit.staff_id)as num ,s.staff_name, '3' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0  GROUP BY audit.staff_id order by num desc LIMIT 20) UNION (select COUNT(audit.staff_id)as num ,s.staff_name, '4' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =0  GROUP BY audit.staff_id order by num desc LIMIT 20);" > /tmp/xml/qq_sum_dx_0.xml;



#微信 个人 聊天记录统计
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; (select COUNT(audit.staff_id)as num ,s.staff_name, '1' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >=CURDATE() and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0  GROUP BY audit.staff_id order by num desc LIMIT 20) UNION  (select COUNT(audit.staff_id)as num ,s.staff_name, '2' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0  GROUP BY audit.staff_id order by num desc LIMIT 20 ) UNION (select COUNT(audit.staff_id)as num ,s.staff_name, '3' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0  GROUP BY audit.staff_id order by num desc LIMIT 20) UNION (select COUNT(audit.staff_id)as num ,s.staff_name, '4' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =0  GROUP BY audit.staff_id order by num desc LIMIT 20);" > /tmp/xml/wx_sum_dx_0.xml;

#QQ 群组 聊天记录统计
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; (select COUNT(audit.staff_id)as num ,s.staff_name, '1' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >=CURDATE() and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1  GROUP BY audit.staff_id order by num desc LIMIT 20) UNION  (select COUNT(audit.staff_id)as num ,s.staff_name, '2' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1  GROUP BY audit.staff_id order by num desc LIMIT 20 ) UNION (select COUNT(audit.staff_id)as num ,s.staff_name, '3' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1  GROUP BY audit.staff_id order by num desc LIMIT 20) UNION (select COUNT(audit.staff_id)as num ,s.staff_name, '4' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name like 'com.tencent.%qq%' and log.talk_type =1  GROUP BY audit.staff_id order by num desc LIMIT 20);" > /tmp/xml/qq_sum_dx_1.xml;



#微信 群组 聊天记录统计
mysql -X -h "$db_ip " -P"$db_port" -u"$db_user" -p"$db_password" -e "use "emm_$db_company"; (select COUNT(audit.staff_id)as num ,s.staff_name, '1' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >=CURDATE() and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1  GROUP BY audit.staff_id order by num desc LIMIT 20) UNION  (select COUNT(audit.staff_id)as num ,s.staff_name, '2' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -6 DAY) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1  GROUP BY audit.staff_id order by num desc LIMIT 20 ) UNION (select COUNT(audit.staff_id)as num ,s.staff_name, '3' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(CURDATE(),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1  GROUP BY audit.staff_id order by num desc LIMIT 20) UNION (select COUNT(audit.staff_id)as num ,s.staff_name, '4' as date_type FROM behavior_chat_log log LEFT JOIN behavior_chat_audit audit ON log.chat_audit_id = audit.chat_audit_id LEFT JOIN pub_staff s ON audit.staff_id = s.staff_id where log.chat_time >= DATE_ADD(DATE_ADD(CURDATE(),INTERVAL -2 month),INTERVAL -(DAYOFMONTH(CURDATE())-1) day) and audit.app_pkg_name ='com.tencent.mm' and log.talk_type =1  GROUP BY audit.staff_id order by num desc LIMIT 20);" > /tmp/xml/wx_sum_dx_1.xml;










#process the "pop up" files, and save them into /tmp/xml/focus(in default)
focus_filelist=`ls /tmp/xml/*_focus_*`
echo "------"
for  ff  in  $focus_filelist
do
  python popup.py $ff
done
